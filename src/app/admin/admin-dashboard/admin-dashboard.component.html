<!-- Wrapper -->
<div class="wrapper">
  <!-- Sidebar -->
  <nav id="sidebar" [class.active]="sidebarCollapsed">
    <div class="sidebar-header">
      <h3><i class="bi bi-shield-check"></i> Admin Panel</h3>
    </div>

    <ul class="list-unstyled components">
      <li [class.active]="activeMenu === 'dashboard'">
        <a (click)="setActiveMenu('dashboard')">
          <i class="bi bi-speedometer2"></i> Dashboard
        </a>
      </li>
      <li [class.active]="activeMenu === 'requests'">
        <a (click)="setActiveMenu('requests')">
          <i class="bi bi-file-earmark-text"></i> Kelola Pengajuan
        </a>
      </li>
      <li [class.active]="activeMenu === 'statistics'">
        <a (click)="setActiveMenu('statistics')">
          <i class="bi bi-bar-chart"></i> Statistik
        </a>
      </li>
      <li [class.active]="activeMenu === 'users'">
        <a (click)="setActiveMenu('users')">
          <i class="bi bi-people"></i> Kelola User
        </a>
      </li>
      <li [class.active]="activeMenu === 'profile'">
        <a (click)="setActiveMenu('profile')">
          <i class="bi bi-person"></i> Profile Admin
        </a>
      </li>
      <li [class.active]="activeMenu === 'settings'">
        <a (click)="setActiveMenu('settings')">
          <i class="bi bi-gear"></i> Pengaturan
        </a>
      </li>
    </ul>

    <div class="sidebar-footer">
      <button class="btn btn-danger btn-sm w-100" (click)="logout()">
        <i class="bi bi-box-arrow-right"></i> Logout
      </button>
    </div>
  </nav>

  <!-- Page Content -->
  <div id="content">
    <!-- Top Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
      <div class="container-fluid">
        <button type="button" id="sidebarCollapse" class="btn btn-outline-primary" (click)="toggleSidebar()">
          <i class="bi bi-list"></i>
        </button>

        <span class="navbar-text ms-3 fw-bold text-primary">
          Sistem Approval
        </span>

        <div class="ms-auto d-flex align-items-center gap-3">
          <div class="dropdown">
            <button class="btn btn-link text-decoration-none dropdown-toggle" type="button" 
                    id="notificationDropdown" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="bi bi-bell fs-5 text-secondary position-relative">
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                  {{ getPendingCount() }}
                </span>
              </i>
            </button>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notificationDropdown">
              <li><h6 class="dropdown-header">Notifikasi</h6></li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <a class="dropdown-item" (click)="setActiveMenu('requests')" style="cursor: pointer;">
                  <i class="bi bi-hourglass text-warning"></i> 
                  {{ getPendingCount() }} pengajuan menunggu
                </a>
              </li>
            </ul>
          </div>

          <div class="dropdown">
            <button class="btn btn-link text-decoration-none dropdown-toggle d-flex align-items-center gap-2" 
                    type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="bi bi-person-circle fs-4 text-primary"></i>
              <span class="text-dark">{{ nama }}</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
              <li><h6 class="dropdown-header">Admin</h6></li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <a class="dropdown-item" (click)="setActiveMenu('profile')">
                  <i class="bi bi-person"></i> Profile
                </a>
              </li>
              <li>
                <a class="dropdown-item" (click)="setActiveMenu('settings')">
                  <i class="bi bi-gear"></i> Settings
                </a>
              </li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <a class="dropdown-item text-danger" (click)="logout()">
                  <i class="bi bi-box-arrow-right"></i> Logout
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid mt-4">
      <!-- Dashboard Summary Cards -->
      <div *ngIf="activeMenu === 'dashboard'" class="fade-in">
        <h2 class="mb-4">Dashboard Overview</h2>
        <div class="row mb-4">
          <div class="col-md-4">
            <div class="card border-0 shadow-sm text-center card-hover">
              <div class="card-body">
                <i class="bi bi-hourglass-split text-warning" style="font-size: 3rem;"></i>
                <h3 class="mt-3 mb-0">{{ getPendingCount() }}</h3>
                <p class="text-muted mb-0">Menunggu Persetujuan</p>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card border-0 shadow-sm text-center card-hover">
              <div class="card-body">
                <i class="bi bi-check-circle text-success" style="font-size: 3rem;"></i>
                <h3 class="mt-3 mb-0">{{ getApprovedCount() }}</h3>
                <p class="text-muted mb-0">Disetujui</p>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card border-0 shadow-sm text-center card-hover">
              <div class="card-body">
                <i class="bi bi-x-circle text-danger" style="font-size: 3rem;"></i>
                <h3 class="mt-3 mb-0">{{ getRejectedCount() }}</h3>
                <p class="text-muted mb-0">Ditolak</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Kelola Pengajuan -->
      <div *ngIf="activeMenu === 'requests'" class="fade-in">
        <h2 class="mb-4">Kelola Pengajuan</h2>
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <app-request-list 
              [requests]="requests" 
              role="admin"
              (requestUpdated)="loadRequests()"
            ></app-request-list>
          </div>
        </div>
      </div>

      <!-- Statistik -->
      <div *ngIf="activeMenu === 'statistics'" class="fade-in">
        <h2 class="mb-4">Statistik Pengajuan</h2>
        <div class="alert alert-info">
          <i class="bi bi-info-circle"></i> Fitur statistik sedang dalam pengembangan
        </div>
      </div>

      <!-- Kelola User -->
      <div *ngIf="activeMenu === 'users'" class="fade-in">
        <h2 class="mb-4">Kelola User</h2>
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <app-user-management></app-user-management>
          </div>
        </div>
      </div>

      <!-- Settings diganti Profile -->
      <div *ngIf="activeMenu === 'profile'" class="fade-in">
        <h2 class="mb-4">Profile Admin</h2>
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <app-admin-profile></app-admin-profile>
          </div>
        </div>
      </div>

      <!-- Settings -->
      <div *ngIf="activeMenu === 'settings'" class="fade-in">
        <h2 class="mb-4">Pengaturan</h2>
        <div class="alert alert-info">
          <i class="bi bi-info-circle"></i> Fitur pengaturan sedang dalam pengembangan
        </div>
      </div>

      <div *ngIf="error" class="alert alert-danger mt-3" role="alert">
        <i class="bi bi-exclamation-triangle"></i> {{ error }}
      </div>
    </div>
  </div>
</div>